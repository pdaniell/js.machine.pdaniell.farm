/*! machine.js (v1.0.0-alpha) 16-Jan-2015 */
"use strict";var Machine={};!function(){Machine={version:"1.0.0-alpha",author:"Paul Daniell"},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=Machine),exports.Machine=Machine):"function"==typeof define&&define.amd?define(function(){return Machine}):"undefined"!=typeof window?window.Machine=Machine:"undefined"!=typeof self&&(self.Machine=Machine)}(),function(){Machine.ClassUtils=function(){},Machine.ClassUtils.extend=function(a,b){for(var c in b.prototype)b.prototype.hasOwnProperty(c)&&(a.prototype.hasOwnProperty(c)||(a.prototype[c]=b.prototype[c]));a.__super__=b.prototype}}(),function(){var a=function(a){function b(a){return typeof a==o?a:""+a}function c(a){var d;return typeof a==o?a:typeof a.hashCode==n?(d=a.hashCode(),typeof d==o?d:c(d)):b(a)}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function e(a,b){return a.equals(b)}function f(a,b){return typeof b.equals==n?b.equals(a):a===b}function g(b){return function(c){if(null===c)throw new Error("null is not a valid "+b);if(c===a)throw new Error(b+" must not be undefined")}}function h(a,b,c,d){this[0]=a,this.entries=[],this.addEntry(b,c),null!==d&&(this.getEqualityFunction=function(){return d})}function i(a){return function(b){for(var c,d=this.entries.length,e=this.getEqualityFunction(b);d--;)if(c=this.entries[d],e(b,c[0]))switch(a){case s:return!0;case t:return c;case u:return[d,c[1]]}return!1}}function j(a){return function(b){for(var c=b.length,d=0,e=this.entries,f=e.length;f>d;++d)b[c+d]=e[d][a]}}function k(a,b){for(var c,d=a.length;d--;)if(c=a[d],b===c[0])return d;return null}function l(a,b){var c=a[b];return c&&c instanceof h?c:null}function m(){var b=[],e={},f={replaceDuplicateKey:!0,hashCode:c,equals:null},g=arguments[0],i=arguments[1];i!==a?(f.hashCode=g,f.equals=i):g!==a&&d(f,g);var j=f.hashCode,m=f.equals;this.properties=f,this.put=function(a,c){q(a),r(c);var d,g,i=j(a),k=null;return d=l(e,i),d?(g=d.getEntryForKey(a),g?(f.replaceDuplicateKey&&(g[0]=a),k=g[1],g[1]=c):d.addEntry(a,c)):(d=new h(i,a,c,m),b.push(d),e[i]=d),k},this.get=function(a){q(a);var b=j(a),c=l(e,b);if(c){var d=c.getEntryForKey(a);if(d)return d[1]}return null},this.containsKey=function(a){q(a);var b=j(a),c=l(e,b);return c?c.containsKey(a):!1},this.containsValue=function(a){r(a);for(var c=b.length;c--;)if(b[c].containsValue(a))return!0;return!1},this.clear=function(){b.length=0,e={}},this.isEmpty=function(){return!b.length};var n=function(a){return function(){for(var c=[],d=b.length;d--;)b[d][a](c);return c}};this.keys=n("keys"),this.values=n("values"),this.entries=n("getEntries"),this.remove=function(a){q(a);var c,d=j(a),f=null,g=l(e,d);return g&&(f=g.removeEntryForKey(a),null!==f&&0==g.entries.length&&(c=k(b,d),b.splice(c,1),delete e[d])),f},this.size=function(){for(var a=0,c=b.length;c--;)a+=b[c].entries.length;return a}}var n="function",o="string",p="undefined";if(typeof encodeURIComponent==p||Array.prototype.splice===a||Object.prototype.hasOwnProperty===a)return null;var q=g("key"),r=g("value"),s=0,t=1,u=2;return h.prototype={getEqualityFunction:function(a){return typeof a.equals==n?e:f},getEntryForKey:i(t),getEntryAndIndexForKey:i(u),removeEntryForKey:function(a){var b=this.getEntryAndIndexForKey(a);return b?(this.entries.splice(b[0],1),b[1]):null},addEntry:function(a,b){this.entries.push([a,b])},keys:j(0),values:j(1),getEntries:function(a){for(var b=a.length,c=0,d=this.entries,e=d.length;e>c;++c)a[b+c]=d[c].slice(0)},containsKey:i(s),containsValue:function(a){for(var b=this.entries,c=b.length;c--;)if(a===b[c][1])return!0;return!1}},m.prototype={each:function(a){for(var b,c=this.entries(),d=c.length;d--;)b=c[d],a(b[0],b[1])},equals:function(a){var b,c,d,e=this.size();if(e==a.size()){for(b=this.keys();e--;)if(c=b[e],d=a.get(c),null===d||d!==this.get(c))return!1;return!0}return!1},putAll:function(a,b){for(var c,d,e,f,g=a.entries(),h=g.length,i=typeof b==n;h--;)c=g[h],d=c[0],e=c[1],i&&(f=this.get(d))&&(e=b(d,f,e)),this.put(d,e)},clone:function(){var a=new m(this.properties);return a.putAll(this),a}},m.prototype.toQueryString=function(){for(var a,c=this.entries(),d=c.length,e=[];d--;)a=c[d],e[d]=encodeURIComponent(b(a[0]))+"="+encodeURIComponent(b(a[1]));return e.join("&")},m}();Machine.HashTable=a}(),function(){Machine.HashSet=function(a,b){var c=new Machine.HashTable(a,b);this.add=function(a){c.put(a,!0)},this.addAll=function(a){for(var b=0,d=a.length;d>b;++b)c.put(a[b],!0)},this.values=function(){return c.keys()},this.remove=function(a){return c.remove(a)?a:null},this.contains=function(a){return c.containsKey(a)},this.clear=function(){c.clear()},this.size=function(){return c.size()},this.isEmpty=function(){return c.isEmpty()},this.clone=function(){var d=new HashSet(a,b);return d.addAll(c.keys()),d},this.intersection=function(d){for(var e,f=new HashSet(a,b),g=d.values(),h=g.length;h--;)e=g[h],c.containsKey(e)&&f.add(e);return f},this.union=function(a){for(var b,d=this.clone(),e=a.values(),f=e.length;f--;)b=e[f],c.containsKey(b)||d.add(b);return d},this.isSubsetOf=function(a){for(var b=c.keys(),d=b.length;d--;)if(!a.contains(b[d]))return!1;return!0},this.complement=function(c){for(var d,e=new HashSet(a,b),f=this.values(),g=f.length;g--;)d=f[g],c.contains(d)||e.add(d);return e}}}(),function(){Machine.ANSI=function(){},Machine.ANSI.ANSI_RESET="[0m",Machine.ANSI.ANSI_BLACK="[30m",Machine.ANSI.ANSI_LIGHT_GRAY="[37m",Machine.ANSI.ANSI_DARK_GRAY="[90m",Machine.ANSI.ANSI_RED="[31m",Machine.ANSI.ANSI_GREEN="[32m",Machine.ANSI.ANSI_YELLOW="[33m",Machine.ANSI.ANSI_BLUE="[34m",Machine.ANSI.ANSI_PURPLE="[35m",Machine.ANSI.ANSI_CYAN="[36m",Machine.ANSI.ANSI_WHITE="[37m",Machine.ANSI.ANSI_BOLD="[1m",Machine.ANSI.ANSI_BOLD_RESET="[21m",Machine.ANSI.ANSI_INVERT="[7m",Machine.ANSI.ANSI_INVERT_RESET="[27m",Machine.ANSI.colorize=function(a,b){var c=""+b;return c+=a,c+=Machine.ANSI.ANSI_RESET},Machine.ANSI.embolden=function(a){return Machine.ANSI.ANSI_BOLD+a+Machine.ANSI.ANSI_BOLD_RESET},Machine.ANSI.invert=function(a){return Machine.ANSI.ANSI_INVERT+a+Machine.ANSI.ANSI_INVERT_RESET}}(),function(){Machine.StringUtils=function(){},Machine.StringUtils.border=function(a,b){for(var c="",d=0;a>d;d++)c+="*";return Machine.ANSI.colorize(c+"\n",b)},Machine.StringUtils.replaceAt=function(a,b,c){return a.substr(0,b)+c+a.substr(b+c.length)},Machine.StringUtils.transformEpsilon=function(a){return a==Machine.Alphabet.EPSILON_STRING?"Îµ":a}}(),function(){Machine.Alphabet=function(a){this._init(a)},Machine.Alphabet.prototype={_init:function(a){if(this.unrestricted=a&&a.hasOwnProperty("unrestricted")&&1==a.unrestricted?!0:!1,a&&a.hasOwnProperty("blank")){if(1!=a.blank.length)throw new Error("Blank character must have length 1");this.blank=a.blank}else this.blank=" ";this.allowsEpsilon=a&&a.hasOwnProperty("allowsEpsilon")?a.allowsEpsilon:!0,a&&a.hasOwnProperty("chars")&&this._setAlphabet(a.chars)},_setAlphabet:function(a){this.alphabetSet=new Machine.HashSet;for(var b=0;b<a.length;b++){var c=a.charAt(b);this.alphabetSet.add(c)}this.alphabetSet.add(this.blank)},getAllowsEpsilon:function(){return this.allowsEpsilon},setAllowsEpsilon:function(a){this.allowsEpsilon=a},contains:function(a){return 1==this.unrestricted?1==a.length||1==this.getAllowsEpsilon()&&a==Machine.Alphabet.EPSILON_STRING?!0:!1:this.alphabetSet.contains(a)||1==this.getAllowsEpsilon()&&a==Machine.Alphabet.EPSILON_STRING?!0:!1},isCompatibleWith:function(a){for(var b=0;b<a.length;b++)if(0==this.contains(a.charAt(b)))return!1;return!0},getBlank:function(){return this.blank},setBlank:function(a){this.blank=a,this.addCharacter(this.blank)},addCharacter:function(a){this.alphabetSet.add(a)},removeCharacter:function(a){this.alphabetSet.remove(a)}},Machine.Alphabet.EPSILON_STRING="",Machine.Alphabet.TALLY_NOTATION=new Machine.Alphabet({blank:"0",chars:"01",allowsEpsilon:!1}),Machine.Alphabet.UNRESTRICTED=new Machine.Alphabet({blank:" ",unrestricted:!0,allowsEpsilon:!0}),Machine.Alphabet.UNRESTRICTED_NOEPSILON=new Machine.Alphabet({blank:" ",unrestricted:!0,allowsEpsilon:!1})}(),function(){Machine.BaseMachine=function(a){this._init(a)},Machine.BaseMachine.prototype={_init:function(a){this.setAlphabet(a&&a.hasOwnProperty("alphabet")?a.alphabet:Machine.Alphabet.UNRESTRICTED),this.stateTable=new Machine.StateTable,this.initialState=null,this.currentState=null,this.isHalted=!1,this.stepCount=0,this.transitionFunction=new Machine.TransitionFunction({alphabet:this.getAlphabet(),stateTable:this.getStateTable()}),this.onAddState=function(){},this.onRemoveState=function(){},this.onAddTransition=function(){},this.onRemoveTransition=function(){},this.onStep=function(){},this.onHalt=function(){}},getAlphabet:function(){return this.alphabet},setAlphabet:function(a){this.alphabet=a},getStateTable:function(){return this.stateTable},setStateTable:function(a){this.stateTable=a},getTransitionFunction:function(){return this.transitionFunction},setTransitionFunction:function(a){this.transitionFunction=a},getInitialState:function(){return this.initialState},setInitialState:function(a){if(0==this.stateTable.contains(a))throw new Error("Initial State is not in State Table");this.initialState=a,null==this.getCurrentState()&&this.setCurrentState(a)},setInitialStateByLabel:function(a){var b=this.stateTable.getStateByLabel(a);this.setInitialState(b)},getCurrentState:function(){return this.currentState},setCurrentState:function(a){if(0==this.stateTable.contains(a))throw new Error("Initial State is not in State Table");this.currentState=a},setCurrentStateByLabel:function(a){var b=this.stateTable.getStateByLabel(a);this.setCurrentState(b)},getIsHalted:function(){return this.isHalted},setIsHalted:function(a){this.isHalted=a},getStepCount:function(){return this.stepCount},setStepCount:function(a){this.stepCount=a},addStateByLabel:function(a,b){var c=new Machine.State({label:a,isAccepting:b});this.addState(c)},addControlStateByLabel:function(a){var b=new Machine.State({label:a,isAccepting:!1});this.addState(b)},addState:function(a){this.stateTable.add(a),this.onAddState.call(a)},removeStateByLabel:function(a){var b=this.stateTable.getStateByLabel(a);this.onRemoveState.call(b)},reset:function(){this.setCurrentState(this.getInitialState()),this.setStepCount(0),this.setIsHalted(!1)},addTransition:function(a,b){this.getTransitionFunction().add(a,b),this.onAddTransition.call(a,b)},removeTransition:function(a){this.getTransitionFunction.removeTransitionByCondition(a),this.onRemoveTransition.call(condiiton)}}}(),function(){Machine.Condition=function(a){this._init(a)},Machine.Condition.prototype={_init:function(a){if(a.state instanceof Machine.State==0)throw new Error("attribs.state not of type Machine.State");this.state=a.state,this.character=a.character,this.stackElement=a.hasOwnProperty("stackElement")?a.stackElement:null},getStackElement:function(){return this.stackElement},setStackElement:function(a){this.stackElement=a},hasStackElement:function(){return null==this.stackElement?!1:!0},getState:function(){return this.state},setState:function(a){if(a instanceof Machine.State==0)throw new Error("attribs.state not of type Machine.State");this.state=a},getCharacter:function(){return this.character},setCharacter:function(a){this.character=a},characterDisplay:function(){var a=Machine.StringUtils.transformEpsilon;return this.hasStackElement()?this.getState().getLabel()+","+a(this.getCharacter())+","+a(this.getStackElement()):this.getState().getLabel()+","+a(this.getCharacter())}}}(),function(){Machine.Command=function(a){this._init(a)},Machine.Command.prototype={_init:function(a){if(a.state instanceof Machine.State==0)throw new Error("attribs.state not of type Machine.State");this.state=a.state,this.action=a.hasOwnProperty("action")&&Machine.Command.isValidAction(a.action)?a.action:null,this.argument=a.hasOwnProperty("argument")?a.argument:null},getState:function(){return this.state},setState:function(a){if(a instanceof Machine.State==0)throw new Error("attribs.state not of type Machine.State");this.state=a},hasAction:function(){return null==this.action?!1:!0},getAction:function(){return this.action},setAction:function(a){1==Machine.Command.isValidAction(a)&&(this.action=a)},removeAction:function(){this.action=null},hasArgument:function(){return null==this.argument?!1:!0},getArgument:function(){return this.argument},setArgument:function(a){this.argument=a},removeArgument:function(){this.argument=null},characterDisplay:function(){if(1==this.hasAction()&&1==this.hasArgument()){var a="";return a=this.getArgument()==Machine.Alphabet.EPSILON_STRING?"Îµ":this.getArgument(),this.getState().getLabel()+","+Machine.Command.getActionCode(this.getAction())+","+a}if(1==this.hasAction()&&0==this.hasArgument())return this.getState().getLabel()+","+Machine.Command.getActionCode(this.getAction());if(0==this.hasAction()&&0==this.hasArgument())return this.getState().getLabel();throw new Error("Invalid commmand: argument with unspecified action.")}};Machine.Command.MOVE_RIGHT="0",Machine.Command.MOVE_LEFT="1",Machine.Command.ERASE="3",Machine.Command.WRITE="4",Machine.Command.NOOP="5",Machine.Command.STACK_CHANGE="6";Machine.Command.ACTION_MAP=new Machine.HashTable,Machine.Command.ACTION_MAP.put(Machine.Command.MOVE_RIGHT,"R"),Machine.Command.ACTION_MAP.put(Machine.Command.MOVE_LEFT,"L"),Machine.Command.ACTION_MAP.put(Machine.Command.ERASE,"Er"),Machine.Command.ACTION_MAP.put(Machine.Command.WRITE,"Wr"),Machine.Command.ACTION_MAP.put(Machine.Command.NOOP,"Np"),Machine.Command.ACTION_MAP.put(Machine.Command.STACK_CHANGE,"St"),Machine.Command.DESCRIPTION_MAP=new Machine.HashTable,Machine.Command.DESCRIPTION_MAP.put("RIGHT",Machine.Command.MOVE_RIGHT),Machine.Command.DESCRIPTION_MAP.put("LEFT",Machine.Command.MOVE_LEFT),Machine.Command.DESCRIPTION_MAP.put("ERASE",Machine.Command.ERASE),Machine.Command.DESCRIPTION_MAP.put("WRITE",Machine.Command.WRITE),Machine.Command.DESCRIPTION_MAP.put("NOOP",Machine.Command.NOOP),Machine.Command.DESCRIPTION_MAP.put("STACKCHANGE",Machine.Command.STACK_CHANGE),Machine.Command.getActionFromDescription=function(a){if(0==Machine.Command.DESCRIPTION_MAP.containsKey(a.trim().toUpperCase()))throw new Error("Invalid action description key:"+a);return Machine.Command.DESCRIPTION_MAP.get(a.trim().toUpperCase())},Machine.Command.isValidAction=function(a){return Machine.Command.ACTION_MAP.containsKey(a)},Machine.Command.getActionCode=function(a){if(0==Machine.Command.isValidAction(a))throw new Error("Invalid action");return Machine.Command.ACTION_MAP.get(a)}}(),function(){Machine.DFA=function(a){this._init(a)},Machine.DFA.prototype={_init:function(a){a?Machine.BaseMachine.prototype._init.call(this,a):Machine.BaseMachine.prototype._init.call(this),this.setAllowEpsilonTransitions(a&&a.hasOwnProperty("allowEpsilonTransitions")?a.allowEpsilonTransitions:!0),this.isAccepted=!1,this.tape=new Machine.Tape({alphabet:this.getAlphabet(),chars:""}),this.pointerPosition=0,this.onAccept=function(){},this.onReject=function(){},this.onPointerChange=function(){}},getAllowEpsilonTransitions:function(){return this.allowEpsilonTransitions},setAllowEpsilonTransitions:function(a){this.allowEpsilonTransitions=a},getIsAccepted:function(){return this.isAccepted},setIsAccepted:function(a){this.isAccepted=a},getPointerPosition:function(){return this.pointerPosition},setPointerPosition:function(a){this.pointerPosition=a,this.onPointerChange.call(this.pointerPosition)},getTape:function(){return this.tape},setTape:function(a){this.tape=a},setInputString:function(a){this.getTape().setChars(a),this.setPointerPosition(0)},reset:function(){Machine.BaseMachine.prototype.reset.call(this),this.setPointerPosition(0),this.setIsAccepted(!1)},addTransitionByStatesAndCharacter:function(a,b,c){if(0==this.getAllowEpsilonTransitions()&&b==Machine.Alphabet.EPSILON_STRING)throw new Error("Epsilon transitions not permitted in this machine");var d=new Machine.Condition({state:a,character:b}),e=new Machine.Command({state:c});this.addTransition(d,e)},addTransitionByStateLabelsAndCharacter:function(a,b,c){var d=this.getStateTable().getStateByLabel(a),e=this.getStateTable().getStateByLabel(c);this.addTransitionByStatesAndCharacter(d,b,e)},removeTransitionByStateLabelsAndCharacter:function(a,b){var c=(this.getStateTable().getStateByLabel(a),new Machine.Condition({state:condiitonState,character:b}));this.removeTrandition(c)},halt:function(){return this.getPointerPosition()>=this.getTape().length()&&0==this.getTransitionFunction().hasEpsilonTransition(this.getCurrentState())?(this.setIsHalted(!0),1==this.getCurrentState().getIsAccepting()?(this.setIsAccepted(!0),this.onAccept.call(this.getCurrentState(),this.getStepCount(),this.getPointerPosition())):(this.setIsAccepted(!1),this.onReject.call(this.getCurrentState(),this.getStepCount(),this.getPointerPosition())),this.onHalt.call(this.getCurrentState(),this.getStepCount(),this.getPointerPosition()),!0):!1},step:function(){if(1==this.getIsHalted())return!0;this.setStepCount(this.getStepCount()+1);var a=this.getCurrentState();if(1==this.halt())return!0;var b=null,c=null;this.getTransitionFunction().hasEpsilonTransition(a)?(b=Machine.Alphabet.EPSILON_STRING,c=this.getTransitionFunction().getEpsilonTransitionCondition(a)):(b=this.getTape().charAt(this.getPointerPosition()),c=new Machine.Condition({state:a,character:b}));var d=this.getTransitionFunction().getCommand(c);return null==d?(this.setIsHalted(!0),this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getPointerPosition()),this.onHalt.call(a,this.getStepCount(),this.getPointerPosition()),!0):(b!=Machine.Alphabet.EPSILON_STRING&&this.setPointerPosition(this.getPointerPosition()+1),this.setCurrentState(d.getState()),this.onStep.call(c,d,this.getStepCount(),this.getPointerPosition()),1==this.halt()?!0:!1)},run:function(a){for(var b=0;a>b;b++){var c=this.step();if(1==c)return!0}return!1},characterDisplay:function(){var a=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED);a+=Machine.ANSI.colorize(this.getTape().characterDisplay(this.getPointerPosition()),Machine.ANSI.ANSI_YELLOW),a+="\n",a+=Machine.ANSI.colorize(this.getStateTable().characterDisplay(this.getCurrentState().getLabel()),Machine.ANSI.ANSI_BLUE),a+=Machine.ANSI.colorize("#"+this.getStepCount()+" Halted: "+Machine.ANSI.invert(this.getIsHalted())+" Accepted: "+Machine.ANSI.invert(this.getIsAccepted())+"\n",Machine.ANSI.ANSI_LIGHT_GRAY);var b=this.getCurrentState(),c=null,d=null;return this.getTransitionFunction().hasEpsilonTransition(b)?(c=Machine.Alphabet.EPSILON_STRING,d=this.getTransitionFunction().getEpsilonTransitionCondition(b)):(c=this.getTape().charAt(this.getPointerPosition()),d=new Machine.Condition({state:b,character:c})),a+=Machine.ANSI.colorize(this.getTransitionFunction().characterDisplay(d),Machine.ANSI.ANSI_GREEN),a+=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED)}},Machine.ClassUtils.extend(Machine.DFA,Machine.BaseMachine)}(),function(){Machine.FST=function(a){this._init(a)},Machine.FST.prototype={_init:function(a){a?Machine.BaseMachine.prototype._init.call(this,a):Machine.BaseMachine.prototype._init.call(this),this.setOutputAlphabet(a&&a.hasOwnProperty("outputAlphabet")?a.outputAlphabet:Machine.Alphabet.UNRESTRICTED),this.setAllowEpsilonTransitions(a&&a.hasOwnProperty("allowEpsilonTransitions")?a.allowEpsilonTransitions:!0),this.isAccepted=!1,this.inputTape=new Machine.Tape({alphabet:this.getAlphabet(),chars:""}),this.outputTape=new Machine.Tape({alphabet:this.getOutputAlphabet(),chars:""}),this.inputPointerPosition=0,this.outputPointerPosition=0,this.onAccept=function(){},this.onReject=function(){},this.onInputPointerChange=function(){},this.onOutputPointerChange=function(){}},getAllowEpsilonTransitions:function(){return this.allowEpsilonTransitions},setAllowEpsilonTransitions:function(a){this.allowEpsilonTransitions=a},getOutputAlphabet:function(){return this.outputAlphabet},setOutputAlphabet:function(a){this.outputAlphabet=a},getIsAccepted:function(){return this.isAccepted},setIsAccepted:function(a){this.isAccepted=a},getInputPointerPosition:function(){return this.inputPointerPosition},setInputPointerPosition:function(a){this.inputPointerPosition=a,this.onInputPointerChange.call(this.inputPointerPosition)},getOutputPointerPosition:function(){return this.outputPointerPosition},setOutputPointerPosition:function(a){this.outputPointerPosition=a,this.onOutputPointerChange.call(this.outputPointerPosition)},getInputTape:function(){return this.inputTape},setInputTape:function(a){this.inputTape=a},getOutputTape:function(){return this.outputTape},setOutputTape:function(a){this.outputTape=a},setInputString:function(a){this.getInputTape().setChars(a),this.setInputPointerPosition(0)},setOutputString:function(a){this.getOutputTape().setChars(a),this.setInputPointerPosition(0)},reset:function(){Machine.BaseMachine.prototype.reset.call(this),this.setInputPointerPosition(0),this.setOutputString(""),this.setOutputPointerPosition(0),this.setIsAccepted(!1)},addTransitionByStatesAndCharacter:function(a,b,c,d){if(d==Machine.Alphabet.EPSILON_STRING&&0==this.getAllowEpsilonTransitions())throw new Error("Epsilon transitions not permitted for this machine");var e=new Machine.Condition({state:a,character:b}),f=new Machine.Command({state:c,action:Machine.Command.WRITE,argument:d});this.addTransition(e,f)},addTransitionByStateLabelsAndCharacter:function(a,b,c,d){var e=this.getStateTable().getStateByLabel(a),f=this.getStateTable().getStateByLabel(c);this.addTransitionByStatesAndCharacter(e,b,f,d)},removeTransitionByStateLabelsAndCharacter:function(a,b){var c=(this.getStateTable().getStateByLabel(a),new Machine.Condition({state:condiitonState,character:b}));this.removeTrandition(c)},halt:function(){var a=this.getCurrentState();return this.getInputPointerPosition()>=this.getInputTape().length()&&0==this.getTransitionFunction().hasEpsilonTransition(a)?(this.setIsHalted(!0),1==a.getIsAccepting()?(this.setIsAccepted(!0),this.onAccept.call(a,this.getStepCount(),this.getInputPointerPosition())):(this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getInputPointerPosition())),this.onHalt.call(a,this.getStepCount(),this.getInputPointerPosition()),!0):void 0},step:function(){if(1==this.getIsHalted())return!0;this.setStepCount(this.getStepCount()+1);var a=this.getCurrentState();if(1==this.halt())return!0;var b=null,c=null;this.getTransitionFunction().hasEpsilonTransition(a)?(b=Machine.Alphabet.EPSILON_STRING,c=this.getTransitionFunction().getEpsilonTransitionCondition(a)):(b=this.getInputTape().charAt(this.getInputPointerPosition()),c=new Machine.Condition({state:a,character:b}));var d=this.getTransitionFunction().getCommand(c);if(null==d)return this.setIsHalted(!0),this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getInputPointerPosition()),this.onHalt.call(a,this.getStepCount(),this.getInputPointerPosition()),!0;if(b!=Machine.Alphabet.EPSILON_STRING&&this.setInputPointerPosition(this.getInputPointerPosition()+1),d.getArgument()!=Machine.Alphabet.EPSILON_STRING)this.getOutputTape().alter(this.getOutputPointerPosition(),d.getArgument()),this.setOutputPointerPosition(this.getOutputPointerPosition()+1);else if(d.getArgument()==Machine.Alphabet.EPSILON_STRING&&0==this.getAllowEpsilonTransitions())throw new Error("Epsilon transitions not permitted for this machine.");return this.setCurrentState(d.getState()),1==this.halt()?!0:(this.onStep.call(c,d,this.getStepCount(),this.getInputPointerPosition()),!1)},run:function(a){for(var b=0;a>b;b++){var c=this.step();if(1==c)return!0}return!1},characterDisplay:function(){var a=Machine.StringUtils.border(5*this.getInputTape().length()+10,Machine.ANSI.ANSI_RED);a+=Machine.ANSI.colorize(this.getInputTape().characterDisplay(this.getInputPointerPosition()),Machine.ANSI.ANSI_YELLOW),a+="\n",a+=Machine.ANSI.colorize(this.getOutputTape().characterDisplay(this.getOutputPointerPosition()),Machine.ANSI.ANSI_YELLOW),a+="\n",a+=Machine.ANSI.colorize(this.getStateTable().characterDisplay(this.getCurrentState().getLabel()),Machine.ANSI.ANSI_BLUE),a+=Machine.ANSI.colorize("#"+this.getStepCount()+" Halted: "+Machine.ANSI.invert(this.getIsHalted())+" Accepted: "+Machine.ANSI.invert(this.getIsAccepted())+"\n",Machine.ANSI.ANSI_LIGHT_GRAY);var b=this.getCurrentState(),c=null,d=null;return this.getTransitionFunction().hasEpsilonTransition(b)?(c=Machine.Alphabet.EPSILON_STRING,d=this.getTransitionFunction().getEpsilonTransitionCondition(b)):(c=this.getInputTape().charAt(this.getInputPointerPosition()),d=new Machine.Condition({state:b,character:c})),a+=Machine.ANSI.colorize(this.getTransitionFunction().characterDisplay(d),Machine.ANSI.ANSI_GREEN),a+=Machine.StringUtils.border(5*this.getInputTape().length()+10,Machine.ANSI.ANSI_RED)}},Machine.ClassUtils.extend(Machine.FST,Machine.BaseMachine)}(),function(){Machine.DPDA=function(a){this._init(a)},Machine.DPDA.ACCEPT_BY_STATE="0",Machine.DPDA.ACCEPT_BY_STACK="1",Machine.DPDA.ACCEPTANCE_MODES_SET=new Machine.HashTable,Machine.DPDA.ACCEPTANCE_MODES_SET.put(Machine.DPDA.ACCEPT_BY_STATE,"State"),Machine.DPDA.ACCEPTANCE_MODES_SET.put(Machine.DPDA.ACCEPT_BY_STACK,"Stack"),Machine.DPDA.prototype={_init:function(a){a?Machine.BaseMachine.prototype._init.call(this,a):Machine.BaseMachine.prototype._init.call(this),this.setStackAlphabet(a&&a.hasOwnProperty("stackAlphabet")?a.stackAlphabet:Machine.Alphabet.UNRESTRICTED),this.acceptanceMode=null,this.isAccepted=!1,this.stack=new Machine.Stack({alphabet:this.getStackAlphabet()}),this.setInitialStackSymbol(a&&a.hasOwnProperty("initialStackSymbol")?a.initialStackSymbol:this.getStackAlphabet().getBlank()),this.tape=new Machine.Tape({alphabet:this.getAlphabet(),chars:""}),this.pointerPosition=0,this.onAccept=function(){},this.onReject=function(){},this.onPointerChange=function(){},this.onStackPop=function(){},this.onStackPush=function(){},this.stackPush(this.getInitialStackSymbol())},getAcceptanceMode:function(){return this.acceptanceMode},getAcceptanceModeName:function(){return Machine.DPDA.ACCEPTANCE_MODES_SET.get(this.getAcceptanceMode())},setAcceptanceMode:function(a){this.acceptanceMode=a},getInitialStackSymbol:function(){return this.initialStackSymbol},setInitialStackSymbol:function(a){if(0==this.getStackAlphabet().contains(a))throw new Error("Invalid initial stack character");this.initialStackSymbol=a},getStackAlphabet:function(){return this.stackAlphabet},setStackAlphabet:function(a){this.stackAlphabet=a},getStack:function(){return this.stack},setStack:function(a){this.stack=a},stackPop:function(){var a=this.getStack().pop();return this.onStackPop.call(a),a},stackPeek:function(){var a=this.getStack().peek();return a},stackPush:function(a){if(0==this.getStackAlphabet().isCompatibleWith(a))throw new Error("Invalid stack string.");this.getStack().push(a),this.onStackPush.call(a)},getIsAccepted:function(){return this.isAccepted},setIsAccepted:function(a){this.isAccepted=a},getPointerPosition:function(){return this.pointerPosition},setPointerPosition:function(a){this.pointerPosition=a,this.onPointerChange.call(this.pointerPosition)},getTape:function(){return this.tape},setTape:function(a){this.tape=a},setInputString:function(a){this.getTape().setChars(a),this.setPointerPosition(0)},reset:function(){Machine.BaseMachine.prototype.reset.call(this),this.setPointerPosition(0),this.getStack().clear(),this.stackPush(this.getInitialStackSymbol()),this.setIsAccepted(!1)},addTransitionByStatesAndCharacter:function(a,b,c,d,e){var f=new Machine.Condition({state:a,character:b,stackElement:c}),g=new Machine.Command({state:e,action:Machine.Command.STACK_CHANGE,argument:d});this.addTransition(f,g)},addTransitionByStateLabelsAndCharacter:function(a,b,c,d,e){var f=this.getStateTable().getStateByLabel(a),g=this.getStateTable().getStateByLabel(e);this.addTransitionByStatesAndCharacter(f,b,c,d,g)},removeTransitionByStateLabelsAndCharacter:function(a,b){var c=(this.getStateTable().getStateByLabel(a),new Machine.Condition({state:condiitonState,character:b,stackElement:stackElement}));this.removeTrandition(c)},halt:function(){var a=this.getCurrentState(),b=this.stackPeek();return this.getPointerPosition()>=this.getTape().length()&&(0==this.getTransitionFunction().hasEpsilonTransition(a)||b==Machine.Alphabet.EPSILON_STRING)?(this.setIsHalted(!0),1==a.getIsAccepting()?(this.setIsAccepted(!0),this.onAccept.call(a,this.getStepCount(),this.getPointerPosition()),this.setAcceptanceMode(Machine.DPDA.ACCEPT_BY_STATE)):1==this.getStack().isEmpty()?(this.setIsAccepted(!0),this.onAccept.call(a,this.getStepCount(),this.getPointerPosition()),this.setAcceptanceMode(Machine.DPDA.ACCEPT_BY_STACK)):(this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getPointerPosition())),this.onHalt.call(a,this.getStepCount(),this.getPointerPosition()),!0):void 0},step:function(){if(1==this.getIsHalted())return!0;this.setStepCount(this.getStepCount()+1);var a=this.getCurrentState(),b=this.stackPeek();if(1==this.halt())return!0;var c=null,d=null;this.getTransitionFunction().hasEpsilonTransition(a)?(c=Machine.Alphabet.EPSILON_STRING,d=this.getTransitionFunction().getEpsilonTransitionCondition(a)):(c=this.getTape().charAt(this.getPointerPosition()),d=new Machine.Condition({state:a,character:c,stackElement:b}));var e=this.getTransitionFunction().getCommand(d);if(null==e)return this.setIsHalted(!0),this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getPointerPosition()),this.onHalt.call(a,this.getStepCount(),this.getPointerPosition()),!0;if(d.getStackElement()!=Machine.Alphabet.EPSILON_STRING){this.stackPop()}return e.getAction()==Machine.Command.STACK_CHANGE&&e.getArgument()!=Machine.Alphabet.EPSILON_STRING&&this.stackPush(e.getArgument()),0==this.getTransitionFunction().hasEpsilonTransition(a)&&this.setPointerPosition(this.getPointerPosition()+1),this.setCurrentState(e.getState()),1==this.halt()?!0:(this.onStep.call(d,e,this.getStepCount(),this.getPointerPosition()),!1)},run:function(a){for(var b=0;a>b;b++){var c=this.step();if(1==c)return!0}return!1},characterDisplay:function(){var a=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED);a+=Machine.ANSI.colorize(this.getTape().characterDisplay(this.getPointerPosition()),Machine.ANSI.ANSI_YELLOW);var b="";this.getIsAccepted()&&(b="["+this.getAcceptanceModeName()+"]"),a+="\n",a+=Machine.ANSI.colorize(this.getStateTable().characterDisplay(this.getCurrentState().getLabel()),Machine.ANSI.ANSI_BLUE),a+=Machine.ANSI.colorize("#"+this.getStepCount()+" Halted: "+Machine.ANSI.invert(this.getIsHalted())+" Accepted: "+Machine.ANSI.invert(this.getIsAccepted()+b)+"\n",Machine.ANSI.ANSI_LIGHT_GRAY),a+=Machine.ANSI.colorize(this.getStack().characterDisplay()+"\n",Machine.ANSI.ANSI_BLUE);var c=this.getCurrentState(),d=this.stackPeek(),e=null,f=null;return this.getTransitionFunction().hasEpsilonTransition(c)?(e=Machine.Alphabet.EPSILON_STRING,f=this.getTransitionFunction().getEpsilonTransitionCondition(c)):(e=this.getTape().charAt(this.getPointerPosition()),f=new Machine.Condition({state:c,character:e,stackElement:d})),a+=Machine.ANSI.colorize(this.getTransitionFunction().characterDisplay(f),Machine.ANSI.ANSI_GREEN),a+=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED)}},Machine.ClassUtils.extend(Machine.DPDA,Machine.BaseMachine)}(),function(){Machine.TM=function(a){this._init(a)},Machine.TM.prototype={_init:function(a){a?Machine.BaseMachine.prototype._init.call(this,a):Machine.BaseMachine.prototype._init.call(this),this.isAccepted=!1,this.tape=new Machine.Tape({alphabet:this.getAlphabet(),chars:""}),this.pointerPosition=0,this.onAccept=function(){},this.onReject=function(){},this.onPointerChange=function(){}},getIsAccepted:function(){return this.isAccepted},setIsAccepted:function(a){this.isAccepted=a},getPointerPosition:function(){return this.pointerPosition},setPointerPosition:function(a){this.pointerPosition=a,this.onPointerChange.call(this.pointerPosition)
},getTape:function(){return this.tape},setTape:function(a){this.tape=a},getTapeContents:function(){return this.getTape().getChars()},setInputString:function(a){this.getTape().setChars(a),this.setPointerPosition(0)},reset:function(){Machine.BaseMachine.prototype.reset.call(this),this.setPointerPosition(0),this.setIsAccepted(!1)},addTransitionByStatesAndCharacter:function(a,b,c,d,e){if(b==Machine.Alphabet.EPSILON_STRING)throw new Error("Epsilon modifications not permitted in this machine");if(c==Machine.Command.WRITE&&(null==d||1!=d.length||0==this.getAlphabet().contains(d)))throw new Error("Invalid argument for Turing Machine write:"+d);var f=new Machine.Condition({state:a,character:b}),g=new Machine.Command({state:e,action:c,argument:d});this.addTransition(f,g)},addTransitionByStateLabelsAndCharacter:function(a,b,c,d,e){var f=this.getStateTable().getStateByLabel(a),g=this.getStateTable().getStateByLabel(e),h=Machine.Command.getActionFromDescription(c);this.addTransitionByStatesAndCharacter(f,b,h,d,g)},removeTransitionByStateLabelsAndCharacter:function(a,b){var c=(this.getStateTable().getStateByLabel(a),new Machine.Condition({state:condiitonState,character:b}));this.removeTrandition(c)},halt:function(){var a=this.getCurrentState();return 1==a.getIsAccepting()?(this.setIsHalted(!0),this.setIsAccepted(!0),this.onAccept.call(a,this.getStepCount(),this.getPointerPosition()),this.onHalt.call(a,this.getStepCount(),this.getPointerPosition()),!0):void 0},step:function(){if(1==this.getIsHalted())return!0;this.setStepCount(this.getStepCount()+1);var a=this.getCurrentState();if(1==this.halt())return!0;var b=this.getTape().charAt(this.getPointerPosition()),c=new Machine.Condition({state:a,character:b}),d=this.getTransitionFunction().getCommand(c);if(null==d)return this.setIsHalted(!0),this.setIsAccepted(!1),this.onReject.call(a,this.getStepCount(),this.getPointerPosition()),this.onHalt.call(a,this.getStepCount(),this.getPointerPosition()),!0;if(d.getAction()==Machine.Command.MOVE_LEFT)0==this.getPointerPosition()?this.getTape().prepend(this.getAlphabet().getBlank()):this.setPointerPosition(this.getPointerPosition()-1);else if(d.getAction()==Machine.Command.MOVE_RIGHT)this.getPointerPosition()>=this.getTape().length()-1&&this.getTape().append(this.getAlphabet().getBlank()),this.setPointerPosition(this.getPointerPosition()+1);else if(d.getAction()==Machine.Command.ERASE)this.getTape().alter(this.getPointerPosition(),this.getAlphabet().getBlank());else if(d.getAction()==Machine.Command.WRITE){var e=d.getArgument();if(null==e)throw new Error("Missing parameter for write.");this.getTape().alter(this.getPointerPosition(),e)}else d.getAction()==Machine.Command.NOOP;return this.setCurrentState(d.getState()),1==this.halt()?!0:(this.onStep.call(c,d,this.getStepCount(),this.getPointerPosition()),!1)},run:function(a){for(var b=0;a>b;b++){var c=this.step();if(1==c)return!0}return!1},characterDisplay:function(){var a=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED);a+=Machine.ANSI.colorize(this.getTape().characterDisplay(this.getPointerPosition()),Machine.ANSI.ANSI_YELLOW),a+="\n",a+=Machine.ANSI.colorize(this.getStateTable().characterDisplay(this.getCurrentState().getLabel()),Machine.ANSI.ANSI_BLUE),a+=Machine.ANSI.colorize("#"+this.getStepCount()+" Halted: "+Machine.ANSI.invert(this.getIsHalted())+" Accepted: "+Machine.ANSI.invert(this.getIsAccepted())+"\n",Machine.ANSI.ANSI_LIGHT_GRAY);var b=this.getCurrentState(),c=this.getTape().charAt(this.getPointerPosition()),d=new Machine.Condition({state:b,character:c});return a+=Machine.ANSI.colorize(this.getTransitionFunction().characterDisplay(d),Machine.ANSI.ANSI_GREEN),a+=Machine.StringUtils.border(5*this.getTape().length()+10,Machine.ANSI.ANSI_RED)}},Machine.ClassUtils.extend(Machine.TM,Machine.BaseMachine)}(),function(){Machine.Stack=function(a){this._init(a)},Machine.Stack.prototype={_init:function(a){this.data=[],this.setAlphabet(a&&a.hasOwnProperty("alphabet")?a.alphabet:Machine.Alphabet.UNRESTRICTED)},getAlphabet:function(){return this.alphabet},setAlphabet:function(a){this.alphabet=a},isEmpty:function(){return this.data.length<=0?!0:!1},peek:function(){return this.data.length>0?this.data[this.data.length-1]:Machine.Alphabet.EPSILON_STRING},pop:function(){return this.data.length>0?this.data.pop():Machine.Alphabet.EPSILON_STRING},push:function(a){if(a!==Machine.Alphabet.EPSILON_STRING){if(0==this.getAlphabet().isCompatibleWith(a))throw new Error("Invalid string for stack push.");for(var b=a.length-1;b>=0;b--){var c=a.charAt(b);this.data.push(c)}}},poppush:function(a){var b=this.pop();if(0==this.getAlphabet().contains(a))throw new Error("Invalid character for stack element");return this.data.push(a),b},clear:function(){this.data=[]},characterDisplay:function(){for(var a="",b=0;b<this.data.length;b++)a+="____";a+="\n",a+=0==this.data.length?Machine.ANSI.invert("|Ã˜|"):"|";for(var b=0;b<this.data.length;b++){var c=this.data[b];b==this.data.length-1?a+=Machine.ANSI.invert("*"+c):a=a+" "+c,a+=" |"}a+="\n";for(var b=0;b<this.data.length;b++)a+="â€¾â€¾â€¾â€¾";return a}}}(),function(){Machine.State=function(a){this._init(a)},Machine.State.prototype={_init:function(a){this.label=a.label,this.isAccepting=a.isAccepting},getIsAccepting:function(){return this.isAccepting},setIsAccepting:function(a){this.isAccepting=a},getLabel:function(){return this.label},setLabel:function(a){this.label=a}}}(),function(){Machine.StateTable=function(a){this._init(a)},Machine.StateTable.prototype={_init:function(){this.stateMap=new Machine.HashTable,this.acceptingStates=new Machine.HashSet,this.controlStates=new Machine.HashSet},add:function(a){if(a instanceof Machine.State==0)throw"Object invalid for adding to state table.";1==a.getIsAccepting()?this.acceptingStates.add(a):this.controlStates.add(a),this.stateMap.put(a.getLabel(),a)},remove:function(a){var b=this.getStateByLabel(a);this.stateMap.remove(a),this.acceptingStates.contains(b)&&this.acceptingStates.remove(b),this.controlStates.contains(b)&&this.controlStates.remove(b)},getControlStates:function(){return this.controlStates},getAcceptingStates:function(){return this.acceptingStates},getStateByLabel:function(a){return null==a?!1:this.stateMap.get(a)},contains:function(a){return null==a?!1:this.stateMap.containsValue(a)?!0:!1},length:function(){return this.stateMap.keys().length},labels:function(){return this.stateMap.keys()},characterDisplay:function(a){var b="";b+=Machine.ANSI.embolden("Control: ");for(var c=0;c<this.controlStates.values().length;c++)b+=this.controlStates.values()[c].getLabel(),a==this.controlStates.values()[c].getLabel()&&(b+="*"),b+=" | ";b+=Machine.ANSI.embolden("Accepting: ");for(var c=0;c<this.acceptingStates.values().length;c++)b+=this.acceptingStates.values()[c].getLabel(),a==this.acceptingStates.values()[c].getLabel()&&(b+="*"),b+=" | ";return b+="\n"}}}(),function(){Machine.Tape=function(a){this._init(a)},Machine.Tape.prototype={_init:function(a){this.setAlphabet(a&&a.hasOwnProperty("alphabet")?a.alphabet:Machine.Alphabet.UNRESTRICTED),this.setChars(a&&a.hasOwnProperty("chars")?a.chars:"")},getAlphabet:function(){return this.alphabet},getChars:function(){return this.chars},setAlphabet:function(a){if(a instanceof Machine.Alphabet==0)throw new Error("Invalid type for alphabet");this.alphabet=a},setChars:function(a){if(0==this.alphabet.isCompatibleWith(a))throw new Error("Incompatible alphabet for contents.");this.chars=a},length:function(){return this.chars.length},charAt:function(a){return this.chars.charAt(a)},hasCharAt:function(a){return 0>a?!1:a>=this.chars.length?!1:!0},prepend:function(a){if(0==this.getAlphabet().isCompatibleWith(a))throw new Error("String incompatible with alphabet");this.chars=a+this.chars},append:function(a){if(0==this.getAlphabet().isCompatibleWith(a))throw new Error("String incompatible with alphabet");this.setChars(this.chars+a)},alter:function(a,b){if(0==this.getAlphabet().contains(b))throw new Error("Incompatible character");if(1!=b.length)throw new Error("Invalid length.");this.chars=Machine.StringUtils.replaceAt(this.chars,a,b)},characterDisplay:function(a){for(var b="",c=0;c<this.chars.length;c++)b+="=====";b+="\n",b+="|";for(var c=0;c<this.chars.length;c++){var d=this.chars.charAt(c);c==a?b+=Machine.ANSI.invert("*"+d):b=b+" "+d,b+=" |"}b+="\n";for(var c=0;c<this.chars.length;c++)b+="=====";return b}}}(),function(){Machine.TransitionFunction=function(a){this._init(a)},Machine.TransitionFunction.prototype={_init:function(a){this.map=new Machine.HashTable,this.epsilonMap=new Machine.HashTable,this.stateTable=a&&a.hasOwnProperty("stateTable")?a.stateTable:new Machine.StateTable,this.alphabet=a&&a.hasOwnProperty("alphabet")?a.alphabet:Machine.Alphabet.UNRESTRICTED,this.requireTotal=a&&a.hasOwnProperty("requireTotal")?a.requireTotal:!1,this.setAllowEpsilonTransitions(a&&a.hasOwnProperty("allowEpsilonTransitions")?a.allowEpsilonTransitions:!0)},getEpsilonMap:function(){return this.epsilonMap},setEpilsonMap:function(a){this.epsilonMap=a},getAllowEpsilonTransitions:function(){return this.allowEpsilonTransitions},setAllowEpsilonTransitions:function(a){this.allowEpsilonTransitions=a},add:function(a,b){if(a instanceof Machine.Condition==0)throw new Error("Invalid condition.");if(0==this.stateTable.contains(a.getState()))throw new Error("Invalid state for condition.");if(0==this.alphabet.contains(a.getCharacter()))throw new Error("Invalid character for condition given alphabet");if(b instanceof Machine.Command==0)throw new Error("Invalid command.");if(0==this.stateTable.contains(b.getState()))throw new Error("Invalid state for command.");if(b.hasAction()&&b.getAction()==Machine.Command.WRITE&&0==this.alphabet.contains(b.getArgument()))throw new Error("Invalid argument for command.");if(a.getCharacter()==Machine.Alphabet.EPSILON_STRING){if(0==this.getAllowEpsilonTransitions())throw new Error("Epsilon transitions not permitted in this function");for(var c=this.getConditions(),d=0;d<c.length;d++){var e=c[d];if(e.getState().getLabel()==a.getState().getLabel())throw new Error("Unable to add epsilon transition because other transitions exist. Delete those first.")}this.getEpsilonMap().put(JSON.stringify(a.getState()),a)}else if(1==this.hasEpsilonTransition(a.getState()))throw new Error("Unable to add transition because there are existing epsilon transitions");return this.map.put(JSON.stringify(a),b),a},hasEpsilonTransition:function(a){return this.getEpsilonMap().containsKey(JSON.stringify(a))},getEpsilonTransitionCondition:function(a){return this.getEpsilonMap().get(JSON.stringify(a))},removeTransitionByCondition:function(a){1==this.hasEpsilonTransition(a.getState())&&this.getEpsilonMap().remove(JSON.stringify(a.getState())),this.map.remove(JSON.stringify(a))},getCommand:function(a){if(0==this.map.containsKey(JSON.stringify(a))&&1==this.requireTotal)throw"Missing transition condition.";return this.map.get(JSON.stringify(a))},getAlphabet:function(){return this.alphabet},getRequireTotal:function(){return this.requireTotal},setRequireTotal:function(a){this.requireTotal=a},getStateTable:function(){return this.stateTable},getConditions:function(){for(var a=this.map.keys(),b=[],c=0;c<a.length;c++){var d=JSON.parse(a[c]),e=new Machine.State({label:d.state.label,isAccepting:d.state.isAccepting}),f=new Machine.Condition({state:e,character:d.character,stackElement:d.stackElement});b[c]=f}return b},setAlphabet:function(a){this.alphabet=a},setStateTable:function(a){this.stateTable=a},getTransitionDescriptions:function(){var a=[];return this.map.each(function(b,c){var d=JSON.parse(b),e="("+d.state.label+":"+d.character+")->"+c.toString();a.push(e)}),a},characterDisplay:function(a){for(var b="",c=this.getConditions().reverse(),d=0;d<c.length;d++){var e=c[d],f=this.getCommand(e);b+=e.getState().getLabel()==a.getState().getLabel()&&e.getCharacter()==a.getCharacter()&&e.getStackElement()==a.getStackElement()?Machine.ANSI.invert("("+e.characterDisplay()+":"+f.characterDisplay()+")"):"("+e.characterDisplay()+":"+f.characterDisplay()+")"}return b+"\n"}}}();